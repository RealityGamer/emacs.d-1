# Function to interact with emacs server

function em {
    # Default settings
    local file=$@[-1]
    local method='vsplit'

    for arg; do
        case "$arg" in
            -b)
                local method='buffer';;
            -t)
                local method='tab';;
            -v)
                local method='vsplit';;
            -s)
                local method='split';;
        esac
    done

    # If file exists, get the full path
    if [[ -f "$file" || -d "$file" ]]; then
        local filepath=$(readlink -f "$file")
    else
        local filepath="$file"
    fi

    local command=''
    case "$method" in
        buffer)
            local command='';;
        split)
            local command='(select-window (split-window-below))';;
        vsplit)                                                     
            local command='(select-window (split-window-right))';;
        tab)                                                        
            local command='(select-frame new-frame))';;
    esac
    local command2='(find-file "'$filepath'")'
    emacsclient -e "$command" -e "$command2"
        
}
